#!/bin/bash

# Script to fix the stupid commas in some of the river names.

# Site 32346 is weird so set an exception then.

awk -F"," '{OFS=","}{
                if (NF==28)
                    print $0
                else if (NF==29 && ($23!=0 && $24!=0))
                    print $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22" - "$23,$24,$25,$26,$27,$28,$29
                else if ($23==0 && $24==0)
                    print $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28" - "$29
                else if (NF==30 && ($23!=0 && $24!=0))
                    print $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22" - "$23" - "$24,$25,$26,$27,$28,$29,$30
                else if (NF==31 && ($23!=0 && $24!=0))
                    print $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22" - "$23" - "$24" - "$25,$26,$27,$28,$29,$30,$31

                }' metadata_*.csv > fixed_metadata.csv

